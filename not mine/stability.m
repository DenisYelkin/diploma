STABILITY.m

d0=b00*b00-b01*b02;
d1=2*b00*b10-b01*b12-b11*b02;
d2=2*b00*b20+b10*b10-b01*b22-b11*b12-b21*b02;
d3=2*b10*b20-b11*b22-b21*b12;
d4=b20*b20-b21*b22;
g0=b00*b01-b02*b02;
g1=b00*b11+b10*b01-2*b02*b12;
g2=b00*b21+b10*b11+b20*b01-b12*b12-2*b02*b22;
g3=b10*b21+b20*b11-2*b12*b22;
g4=b20*b21-b22*b22;
 
Cond1=b00 + b10 + b20 + b02 + b12 + b22;
Cond2=b00-b10+b20-b02+b12-b22;
Cond3=d0+g0+d1+g1+d2+g2+d3+g3+d4+g4;
Cond4=d0-g0-d1+g1+d2-g2-d3+g3+d4-g4;
 
y1=(Cond1>0)&(Cond2>0)&(Cond3>0)&(Cond4>0); 
 
 
  A05=abs(b00+b02);
  A15=(b10+b12)*sign(b00+b02);
  A25=(b20+b22)*sign(b00+b02);
  
  A06=abs(b00-b02);
  A16=(b10-b12)*sign(b00-b02);
  A26=(b20-b22)*sign(b00-b02);
     
C05=A05+A15+A25;
C15=2*(A05-A25);
C25=A05-A15+A25;
 
C06=A06+A16+A26;
C16=2*(A06-A26);
C26=A06-A16+A26;
 
y2=(C05>0)&(C15>0)&(C25>0);
y3=(C06>0)&(C16>0)&(C26>0);
 
%For cond7 and cond8
 
A07=abs(d0+g0);
A17=(d1+g1)*sign(d0+g0);
A27=(d2+g2)*sign(d0+g0);
A37=(d3+g3)*sign(d0+g0);
A47=(d4+g4)*sign(d0+g0);
 
A08=abs(d0-g0);
A18=(d1-g1)*sign(d0-g0);
A28=(d2-g2)*sign(d0-g0);
A38=(d3-g3)*sign(d0-g0);
A48=(d4-g4)*sign(d0-g0);
 
C07=A07+A17+A27+A37+A47;
C17=4*(A07-A47)+2*(A17-A37);
C27=6*(A07+A47)-2*A27;
C37=4*(A07-A47)+2*(A37-A17);
C47=A07-A17+A27-A37+A47;
 
C08=A08+A18+A28+A38+A48;
C18=4*(A08-A48)+2*(A18-A38);
C28=6*(A08+A48)-2*A28;
C38=4*(A08-A48)+2*(A38-A18);
C48=A08-A18+A28-A38+A48;
 
y4=(C07>0)&(C17>0)&(C27>0)&(C37>0)&(C47>0);
y5=(C08>0)&(C18>0)&(C28>0)&(C38>0)&(C48>0);
 
yfinal=y1&y2&y3&y4&y5
